<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Danh mục nhận nuôi - FOURPAWS</title>
    <link href="assets/profile_pet.css" rel="stylesheet" />
    <link
      href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1"
    />
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#FF9EAA",
              "primary-hover": "#F472B6",
              secondary: "#FCD34D",
              background: "#FFFBEB",
            },
            fontFamily: { sans: ["Spline Sans", "sans-serif"] },
          },
        },
      };
    </script>
    <style>
      .reveal {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s ease-out;
      }
      .reveal.active {
        opacity: 1;
        transform: translateY(0);
      }
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
    </style>
  </head>
  <body class="bg-background text-gray-800">
    <div id="header"></div>
    <div id="header-placeholder"></div>

    <div class="relative h-[400px] overflow-hidden">
      <img
        src="assets/picture/images/banner.png"
        class="w-full h-full object-cover brightness-75"
        alt="Banner"
      />
      <div
        class="absolute inset-0 flex flex-col items-center justify-center text-white text-center px-4"
      >
        <h1 class="text-5xl font-bold mb-4 drop-shadow-lg">
          Danh Mục Nhận Nuôi
        </h1>
        <p class="text-lg opacity-90 italic">
          Mở rộng vòng tay - Chữa lành những trái tim nhỏ bé
        </p>
      </div>
    </div>

    <main class="max-w-[1280px] mx-auto px-4 py-12">
      <section class="grid md:grid-cols-2 gap-12 mb-20 items-center reveal">
        <div class="space-y-6">
          <h2
            class="text-3xl font-bold text-gray-900 border-l-4 border-primary pl-4"
          >
            Quy Trình Nhận Nuôi
          </h2>
          <p class="text-gray-600 leading-relaxed">
            Trước khi quyết định nhận nuôi, hãy đảm bảo bạn sẵn sàng chịu trách
            nhiệm cả đời cho bé về tài chính, nơi ở và tinh thần.
          </p>
          <div class="space-y-4">
            <div
              class="flex items-center gap-4 bg-white p-4 rounded-2xl shadow-sm border border-pink-100"
            >
              <span
                class="bg-primary text-white w-8 h-8 flex items-center justify-center rounded-full font-bold"
                >1</span
              >
              <p class="font-medium">Tìm hiểu bé qua danh sách dưới đây</p>
            </div>
            <div
              class="flex items-center gap-4 bg-white p-4 rounded-2xl shadow-sm border border-pink-100"
            >
              <span
                class="bg-primary text-white w-8 h-8 flex items-center justify-center rounded-full font-bold"
                >2</span
              >
              <p class="font-medium">
                Xem thông tin chi tiết và nhấn "Nhận nuôi"
              </p>
            </div>
          </div>
        </div>
        <div
          class="bg-white p-8 rounded-3xl shadow-xl border border-yellow-100"
        >
          <h3
            class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2"
          >
            <span class="material-symbols-outlined text-secondary"
              >verified_user</span
            >Điều Kiện Nhận Nuôi
          </h3>
          <ul class="space-y-4 text-sm">
            <li class="flex items-center gap-3">
              <span class="material-symbols-outlined text-green-500"
                >check_circle</span
              >Tài chính tự chủ và ổn định.
            </li>
            <li class="flex items-center gap-3">
              <span class="material-symbols-outlined text-green-500"
                >check_circle</span
              >Ưu tiên sinh sống tại khu vực trạm quản lý.
            </li>
            <li class="flex items-center gap-3">
              <span class="material-symbols-outlined text-green-500"
                >check_circle</span
              >Cam kết tiêm phòng định kỳ.
            </li>
          </ul>
        </div>
      </section>

      <section class="mb-20 reveal">
        <div
          class="rounded-3xl overflow-hidden shadow-xl border-4 border-white"
        >
          <img
            src="assets/picture/images/bannerbottom.jpg"
            class="w-full h-auto object-cover"
            alt="Banner bottom"
          />
        </div>
      </section>

      <section id="find-pets" class="reveal">
        <h2 class="text-4xl font-bold text-center mb-12">Tìm bạn đồng hành</h2>

        <div
          class="bg-white p-8 rounded-3xl shadow-lg border border-pink-50 mb-12"
        >
          <div class="grid grid-cols-2 lg:grid-cols-6 gap-4">
            <div>
              <label
                class="block text-xs font-bold uppercase text-gray-400 mb-2"
                >Loài</label
              >
              <select
                id="type"
                class="w-full rounded-xl border-gray-200 focus:ring-primary focus:border-primary text-sm h-11"
              >
                <option value="all">Tất cả</option>
                <option value="dog">Chó</option>
                <option value="cat">Mèo</option>
              </select>
            </div>
            <div>
              <label
                class="block text-xs font-bold uppercase text-gray-400 mb-2"
                >Giới tính</label
              >
              <select
                id="gender"
                class="w-full rounded-xl border-gray-200 focus:ring-primary focus:border-primary text-sm h-11"
              >
                <option value="all">Tất cả</option>
                <option value="Đực">Đực</option>
                <option value="Cái">Cái</option>
              </select>
            </div>
            <div>
              <label
                class="block text-xs font-bold uppercase text-gray-400 mb-2"
                >Độ tuổi</label
              >
              <select
                id="age"
                class="w-full rounded-xl border-gray-200 focus:ring-primary focus:border-primary text-sm h-11"
              >
                <option value="all">Tất cả</option>
                <option value="Trẻ">Trẻ</option>
                <option value="Trưởng thành">Trưởng thành</option>
                <option value="Lớn tuổi">Lớn tuổi</option>
              </select>
            </div>
            <div>
              <label
                class="block text-xs font-bold uppercase text-gray-400 mb-2"
                >Triệt sản</label
              >
              <select
                id="sterilized"
                class="w-full rounded-xl border-gray-200 focus:ring-primary focus:border-primary text-sm h-11"
              >
                <option value="all">Tất cả</option>
                <option value="Rồi">Đã triệt sản</option>
                <option value="Chưa">Chưa triệt sản</option>
              </select>
            </div>
            <div>
              <label
                class="block text-xs font-bold uppercase text-gray-400 mb-2"
                >Tên thú cưng</label
              >
              <input
                type="text"
                id="keyword"
                placeholder="Nhập tên..."
                class="w-full rounded-xl border-gray-200 focus:ring-primary focus:border-primary text-sm h-11"
              />
            </div>
            <div>
              <label
                class="block text-xs font-bold uppercase text-gray-400 mb-2"
                >&nbsp;</label
              >
              <button
                id="searchBtn"
                class="w-full bg-primary hover:bg-primary-hover text-white font-bold h-11 rounded-xl shadow-md flex items-center justify-center gap-2 transition-all"
              >
                <span class="material-symbols-outlined text-[20px]">search</span
                >Lọc
              </button>
            </div>
          </div>
        </div>

        <div
          id="petList"
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 min-h-[400px]"
        ></div>

        <div
          id="pagination"
          class="flex justify-center items-center gap-4 mt-16"
        ></div>
      </section>
    </main>

    <div id="footer-placeholder"></div>

    <script>
      // Reveal animation on scroll
      window.addEventListener("scroll", () => {
        document.querySelectorAll(".reveal").forEach((el) => {
          if (el.getBoundingClientRect().top < window.innerHeight - 100)
            el.classList.add("active");
        });
      });

      let allPets = [];
      let filteredPets = [];
      const itemsPerPage = 8;
      let currentPage = 1;

      // 1. Fetch dữ liệu từ pets.json
      async function fetchPets() {
        try {
          const res = await fetch("assets/data/pets.json");
          if (!res.ok) throw new Error("Không thể tải file pets.json");

          const data = await res.json();

          // 2. Chuyển đổi dữ liệu phân cấp thành mảng phẳng
          allPets = [];
          data.categories.forEach((cat) => {
            cat.products.forEach((p) => {
              const info = p.specs["Thông tin"] || {};
              allPets.push({
                id: p.id,
                name: p.name,
                image: p.defaultImage,
                hoverImage: p.hoverImage,
                type: cat.id, // 'dog' hoặc 'cat'
                gender: info["Giới tính"],
                age: info["Tuổi"],
                color: info["Màu sắc"],
                sterilized: info["Triệt sản"],
                vaccinated: info["Tiêm phòng"],
              });
            });
          });

          filteredPets = [...allPets];
          renderPets();
        } catch (err) {
          console.error("Lỗi:", err);
          document.getElementById(
            "petList"
          ).innerHTML = `<p class="col-span-full text-center py-20 text-red-500">Lỗi kết nối dữ liệu: ${err.message}</p>`;
        }
      }

      // 3. Hiển thị danh sách thú cưng
      function renderPets() {
        const list = document.getElementById("petList");
        list.innerHTML = "";

        const start = (currentPage - 1) * itemsPerPage;
        const end = start + itemsPerPage;
        const pageItems = filteredPets.slice(start, end);

        if (pageItems.length === 0) {
          list.innerHTML =
            '<div class="col-span-full text-center py-20 text-gray-400">Không tìm thấy bé nào phù hợp :(</div>';
          return;
        }

        pageItems.forEach((pet) => {
          list.innerHTML += `
                    <div class="bg-white rounded-3xl overflow-hidden shadow-md hover:shadow-2xl transition-all group reveal active border border-pink-50 relative">
                        <div class="h-64 relative overflow-hidden">
                            <img src="${
                              pet.image
                            }" class="w-full h-full object-cover transition-opacity duration-500 group-hover:opacity-0" alt="${
            pet.name
          }">
                            <img src="${
                              pet.hoverImage || pet.image
                            }" class="absolute inset-0 w-full h-full object-cover opacity-0 group-hover:opacity-100 transition-all duration-500 scale-100 group-hover:scale-110" alt="${
            pet.name
          } hover">
                            
                            <div class="absolute top-4 left-4 bg-white/90 backdrop-blur-sm px-3 py-1 rounded-full text-xs font-bold text-primary z-10 shadow-sm">
                                ${pet.gender} • ${pet.age}
                            </div>
                        </div>
                        <div class="p-6">
                            <h3 class="text-xl font-bold text-gray-900 mb-3">${
                              pet.name
                            }</h3>
                            <div class="flex flex-wrap gap-2 mb-4 text-[10px] font-bold uppercase">
                                <span class="bg-yellow-50 text-yellow-600 px-2 py-1 rounded">Màu: ${
                                  pet.color
                                }</span>
                                <span class="bg-green-50 text-green-600 px-2 py-1 rounded">Triệt sản: ${
                                  pet.sterilized
                                }</span>
                                <span class="bg-blue-50 text-blue-600 px-2 py-1 rounded">Tiêm: ${
                                  pet.vaccinated
                                }</span>
                            </div>
                            <button onclick="window.location.href='profile_pet.html?id=${
                              pet.id
                            }'" 
                                    class="w-full bg-secondary hover:bg-yellow-400 text-gray-900 font-bold py-3 rounded-2xl transition-all shadow-sm">
                                Xem hồ sơ bé
                            </button>
                        </div>
                    </div>
                `;
        });
        updatePagination();
      }

      // 4. Logic Lọc dữ liệu
      document.getElementById("searchBtn").addEventListener("click", () => {
        const type = document.getElementById("type").value;
        const gender = document.getElementById("gender").value;
        const age = document.getElementById("age").value;
        const sterilized = document.getElementById("sterilized").value;
        const keyword = document.getElementById("keyword").value.toLowerCase();

        filteredPets = allPets.filter((p) => {
          return (
            (type === "all" || p.type === type) &&
            (gender === "all" || p.gender === gender) &&
            (age === "all" || p.age === age) &&
            (sterilized === "all" || p.sterilized === sterilized) &&
            p.name.toLowerCase().includes(keyword)
          );
        });

        currentPage = 1;
        renderPets();
        document.getElementById("find-pets").scrollIntoView();
      });

      // 5. Phân trang
      function updatePagination() {
        const pg = document.getElementById("pagination");
        const totalPages = Math.ceil(filteredPets.length / itemsPerPage);
        pg.innerHTML = "";
        if (totalPages <= 1) return;

        for (let i = 1; i <= totalPages; i++) {
          pg.innerHTML += `
                    <button onclick="goToPage(${i})" class="w-10 h-10 rounded-full font-bold transition-all ${
            currentPage === i
              ? "bg-primary text-white shadow-lg"
              : "bg-white text-gray-600 hover:bg-pink-100 shadow-sm"
          }">${i}</button>`;
        }
      }

      window.goToPage = (page) => {
        currentPage = page;
        renderPets();
        document.getElementById("find-pets").scrollIntoView();
      };

      // Khởi tạo
      fetchPets();
    </script>
    <div id="footer"></div>
  </body>
</html>
<script>
  // load header
  fetch("assets/Component/header1.html")
    .then((res) => res.text())
    .then((data) => (document.getElementById("header").innerHTML = data));

  // load footer
  fetch("assets/Component/footer.html")
    .then((res) => res.text())
    .then((data) => (document.getElementById("footer").innerHTML = data));
</script>
